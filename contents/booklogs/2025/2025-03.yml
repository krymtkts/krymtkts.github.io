- date: 2025-03-01
  bookTitle: ピクルスと漬物の歴史
  pages: 127 ~ 133
  notes: |
    南アジアの漬物はイギリス・アメリカといった大西洋の国々に強く影響を与えた。
    インドのアーユルベーダが酸味≒漬物の価値を確立。
    アチャールで特徴的なのはごま油やマスタードオイルで漬ける点。火の代わりに強烈な太陽光で細菌やカビを殺し腐敗を防ぐ。
    チャツネもインドから大西洋を渡った。
    油で漬けるのはちょっと容器的な意味でハードル高いが覚えておく。
- date: 2025-03-02
  bookTitle: ピクルスと漬物の歴史
  pages: 134 ~ 157
  notes: |
    イギリス人は漬物の象徴のような存在だった。
    家庭菜園から保存の必要で始まり、インドとの交易で風変わりな漬物に発展。ゆで卵の酢漬けもこの頃文献に現れる。
    ただ色鮮やかな漬物への愛が銅の添加による緑青中毒にまでつながる。肉・鳥・魚の漬物も積極的に行われた。
    イギリスとチャツネとの出会い、レシピ考案者のメジャー・グレイの名は今も残る。
    そしてウスターソース。タマリンド・アンチョビを樽熟成することで生まれた。
    しかしケチャップははじめきのこの漬物から染み出す茶色い漬け汁キャチャップだった。
    トマトの可能性に気づきトマトケチャップを生んだのはイギリスからの流行を受けたアメリカだった。
    アメリカのピクルスで名を馳せたハインツもトマトケチャップ製造に参入。他にはアメリカ・ルイジアナではタバスコが生まれた。
    歴史としては面白くもっと探求したいが、喫緊の漬物テーマにはちょっとソースの話題過ぎて沿わないかなｗ
- date: 2025-03-03
  bookTitle: ピクルスと漬物の歴史
  pages: 158 ~ 169
  notes: |
    現代の漬物は非醗酵と古き良き醗酵の二手に分かれている。特にアメリカは非醗酵の漬物が市場を占める。
    健康への利点・自然食品の流行で自然醗酵の漬物も再評価されている。
    ピクルス液の飲料やアイスキャンディー、ピックルバックといった新しい使い方も現れた。
    しかし漬物の食べ過ぎが癌のリスクを高めるという報告もある。また塩分過多も問題。
    漬物の、傷みやすい食材を長期保存可能にする自然技術という側面は、食糧問題でも注目されている。
    これで本編は終わり。最後はまとめに入ってきたから漬物アイデアには特になかったが流れは興味深かった。
    醗酵リバイバルの話もあるし、減り続ける「家庭の漬物」を細々と続けるのもいいもんや。
- date: 2025-03-04
  bookTitle: ピクルスと漬物の歴史
  pages: 170 ~ 192
  notes: |
    訳者あとがきにある通り、何か漬けたくなる気持ちは増幅した。読む前から漬けるアイデア探してたのもあって。
    とりあえず今回は茄子・ピーマン・キュウリ・セロリあたりの組み合わせで漬けてみる。ニンニクモ添えて。
    キムチやトールシを見て複数の野菜を混ぜたくなった。ただし味付けは純粋に塩と前の漬け汁。鷹の爪くらいはいれるか？
    あと近い内に塩レモンはいつか漬けてみたい。ノーワックスのレモンを仕入れるしかないよな。
- date: 2025-03-05
  bookTitle: プログラマーのための CPU 入門 CPU は如何にしてソフトウェアを高速に実行するか
  pages: 157 ~ 169
  notes: |
    第 10 章 キャッシュコヒーレンス。
    共有メモリ型のマルチプロセッサシステムで個々の CPU が持つキャッシュに書き込んだ値を適切に他の CPU に伝える仕組みがキャッシュコヒーレンス制御。 coherence とは「最新の値が読み出されること」。
    ハードウェア的に解決する方法としては CPU の状態を除き見する snoop 方式と共通のテーブルで管理する directory 方式がある。プロセッサ数が多いと後者が用いられる傾向があるが 1 回あたりの処理性能は前者が優る。
    スヌープ方式には書き込み時に他のキャッシュを無効化する write invalidate と他のキャッシュにも書き込む write update があり、前者が主流。
    write invalidate の主流プロトコル MSI では無効化されたキャッシュの次に他の CPU のキャッシュを取得するため CPU 間の通信が発生する。
    キャッシュが無効化されることで他の CPU で必ずキャッシュミスを起こす。これを coherence miss という。
    また false sharing と呼ばれる、異なる CPU が同じキャッシュラインを使うことで本来は関係ない箇所でキャッシュミスが発生する問題もある。
    false sharing やばいな...こんなん padding で回避とか？限界がある気がするけど。
- date: 2025-03-06
  bookTitle: プログラマーのための CPU 入門 CPU は如何にしてソフトウェアを高速に実行するか
  pages: 170 ~ 176
  notes: |
    第 10 章 キャッシュコヒーレンス。
    ソフトウェア的には汎用的な対策は難しい。
    送受信の頻度を下げる、キャッシュライン配置の工夫、 write combine, write gather といったハードウェア的な支援、 NUMA 構成のような CPU のグループ内の通信コストが低くなるような構成がある。
    コヒーレンスミスの実験では POSIX thread 間で同一のキャッシュラインに書き込み false sharing を再現。実行する CPU が 1 つの方が速くなる。
    低レベルまで降りないと中々実感で来ないけど恐ろしい話や。
- date: 2025-03-07
  bookTitle: プログラマーのための CPU 入門 CPU は如何にしてソフトウェアを高速に実行するか
  pages: 177 ~ 181
  notes: |
    第 11 章 メモリ順序付け。
    共有メモリ型のマルチプロセッサに於いて、主にメモリアクセスの高速化のために 1 つの CPU から見たメモリアクセスの順序が入れ替わることがある。
    この対象となるのは一般的には異なるアドレスへの複数のメモリアクセスのみ。同一のアドレスの場合はデータ依存関係を壊す可能性があるため。
    メモリアクセス順序の入れ替えを許可する・しない状況は CPU 各社によって違う。 x86 は控えめで Arm RISC-V は積極的。
    メモリアクセスが 1 つの CPU からどう見える化を memory consistency と呼び、いくつかのモデルが定式化されている。
    x86 は Total Store Ordering 、 Arm や RISC-V は release consistency 、他にも sequential consistency 、 weak ordering 等がある。
    実際のところ、各 CPU のメモリアクセス仕様は定式化されたモデルよりも複雑。
    GCC の最適化で命令の並び替えがあったと思うが、アレの CPU 実行時レベルでのやつかな？
- date: 2025-03-08
  bookTitle: プログラマーのための CPU 入門 CPU は如何にしてソフトウェアを高速に実行するか
  pages: 181 ~ 187
  notes: |
    第 11 章 メモリ順序付け。
    メモリアクセス順序が変わるメカニズム。
    バンク構成≒メモリアクセスを同時処理する領域で待ちが発生したとき。
    ストアバッファ(store buffer, store queue, write buffer)の先行処理の滞留。
    先行する処理でキャッシュミス、後続する処理でキャッシュがあるようなとき。
    複数の CPU の組み合わせで異なるメモリアクセス順序になると偶発的なソフトウェアの不具合の原因になる。
    この不具合となり得る状態は非同期なプログラムでもよくあるから感覚はつかめるよな。
- date: 2025-03-09
  bookTitle: プログラマーのための CPU 入門 CPU は如何にしてソフトウェアを高速に実行するか
  pages: 188 ~ 194
  notes: |
    第 11 章 メモリ順序付け。
    メモリ順序付け命令で memory ordering instruction (memory barrier instruction, memory fence instruction とも) で必要な箇所でメモリアクセスの順序を強制する
    双方向(ロードのみ、ストアのみ、全て)・単方向の種類がある。 x86 には単方向がない。
    単方向では acquire release があり、これにより保護したい区間の順序を保持しつつ、区間外からの入れ替えを許容してある程度性能劣化を抑制できる利点がある。
    ただし順序の強制によって入れ替えが抑制され、命令実行の機会を失うことになる。
    はじめの方で学んだ高速化のツケが回ってきてるなという感じがしなくもないが高速化しないと意味ないしなあ。難し。
