<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <meta charset="utf-8"/>
    <title>krymtkts: go ã® map ã®ã‚­ãƒ¼ã® Tips</title>
    <link rel="canonical" href="https://krymtkts.github.io/posts/2021-02-01-go-map-key-tips">
    <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
    <meta name="description" content="krymtkts&#39;s personal blog">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:description" content="krymtkts&#39;s personal blog" />
    <meta property="og:site_name" content="krymtkts" />
    <meta property="og:title" content="krymtkts: go ã® map ã®ã‚­ãƒ¼ã® Tips" />
    <meta property="og:url" content="https://krymtkts.github.io/posts/2021-02-01-go-map-key-tips" />
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/solarized-dark.min.css" integrity="sha256-90Y+fvi28WF+3jKH4tHEkoQ9WLeFKJjpvCPNOtU9ZvU=" crossorigin="anonymous" />
    <link href="/css/screen.css" rel="stylesheet" type="text/css" />
</head>
<body>


<nav class="navbar navbar-default">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">krymtkts</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                <li ><a href="/">Home</a></li>
                <li
                ><a href="/archives">Archives</a></li>
                
                <li
                >
                <a href="/pages/about">About Me</a>
                </li>
                
                <li><a href="/feed.xml">RSS</a></li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
                        More <span class="caret"></span></a>
                    <ul class="dropdown-menu" role="menu">
                        

                        
                        <li class="dropdown-header">Recent Posts</li>
                        
                        <li><a href="/posts/2022-04-16-convert-hatena-xml-to-md">å¤ã®ã¯ã¦ãªãƒ€ã‚¤ã‚¢ãƒªãƒ¼ XML ã‚’ Markdwon ã«å¤‰æ›ã™ã‚‹(ã„ã„æ„Ÿã˜ã«)</a></li>
                        
                        <li><a href="/posts/2022-04-09-jobchange-2022">è»¢è·ã—ãŸ 2022</a></li>
                        
                        <li><a href="/posts/2022-04-02-convert-textile-to-md">Textile ã‚’ Markdown ã«å¤‰æ›ã™ã‚‹(ã„ã„æ„Ÿã˜ã«)</a></li>
                        
                        

                        
                        <li class="divider"></li>
                        <li class="dropdown-header">Tags</li>
                        
                        <li><a href="/tags/biasamp">biasamp</a></li>
                        
                        <li><a href="/tags/poco">poco</a></li>
                        
                        <li><a href="/tags/tips">tips</a></li>
                        
                        <li><a href="/tags/evernote">evernote</a></li>
                        
                        <li><a href="/tags/qunit">qunit</a></li>
                        
                        <li><a href="/tags/cryogen">cryogen</a></li>
                        
                        <li><a href="/tags/nyc">nyc</a></li>
                        
                        <li><a href="/tags/diary">diary</a></li>
                        
                        <li><a href="/tags/github">github</a></li>
                        
                        <li><a href="/tags/clojure">clojure</a></li>
                        
                        <li><a href="/tags/vscode">vscode</a></li>
                        
                        <li><a href="/tags/stepfunctions">stepfunctions</a></li>
                        
                        <li><a href="/tags/aws">aws</a></li>
                        
                        <li><a href="/tags/shieldsio">shieldsio</a></li>
                        
                        <li><a href="/tags/retrospective">retrospective</a></li>
                        
                        <li><a href="/tags/boto3">boto3</a></li>
                        
                        <li><a href="/tags/job">job</a></li>
                        
                        <li><a href="/tags/oh-my-posh">oh-my-posh</a></li>
                        
                        <li><a href="/tags/elm">elm</a></li>
                        
                        <li><a href="/tags/elb">elb</a></li>
                        
                        <li><a href="/tags/openssh">openssh</a></li>
                        
                        <li><a href="/tags/powershell">powershell</a></li>
                        
                        <li><a href="/tags/gist">gist</a></li>
                        
                        <li><a href="/tags/planck">planck</a></li>
                        
                        <li><a href="/tags/acm">acm</a></li>
                        
                        <li><a href="/tags/php">php</a></li>
                        
                        <li><a href="/tags/go">go</a></li>
                        
                        <li><a href="/tags/mechanicalkeyboard">mechanicalkeyboard</a></li>
                        
                        <li><a href="/tags/pandoc">pandoc</a></li>
                        
                        <li><a href="/tags/windows">windows</a></li>
                        
                        <li><a href="/tags/maven">maven</a></li>
                        
                        <li><a href="/tags/font">font</a></li>
                        
                        <li><a href="/tags/git">git</a></li>
                        
                        <li><a href="/tags/docker">docker</a></li>
                        
                        <li><a href="/tags/todo">todo</a></li>
                        
                        <li><a href="/tags/sh">sh</a></li>
                        
                        <li><a href="/tags/cement">cement</a></li>
                        
                        <li><a href="/tags/psake">psake</a></li>
                        
                        <li><a href="/tags/textlin">textlin</a></li>
                        
                        <li><a href="/tags/python">python</a></li>
                        
                        <li><a href="/tags/golang">golang</a></li>
                        
                        <li><a href="/tags/fnm">fnm</a></li>
                        
                        <li><a href="/tags/lambda">lambda</a></li>
                        
                        <li><a href="/tags/tortoisegit">tortoisegit</a></li>
                        
                        <li><a href="/tags/docker-toolbox">docker-toolbox</a></li>
                        
                        <li><a href="/tags/serverless">serverless</a></li>
                        
                        <li><a href="/tags/qmkfirmware">qmkfirmware</a></li>
                        
                        <li><a href="/tags/nodejs">nodejs</a></li>
                        
                        <li><a href="/tags/goal">goal</a></li>
                        
                        <li><a href="/tags/powershellgallery">powershellgallery</a></li>
                        
                        <li><a href="/tags/puppeteer">puppeteer</a></li>
                        
                        
                    </ul>
                </li>
            </ul>
        </div><!--/.nav-collapse -->
    </div><!--/.container-fluid -->
</nav>


<div class="container">
    <div class="row">
        <div class="col-lg-12">
            <div id="content">
                
<div id="post">
    <div class="post-header">
    <div id="post-meta" class="row">
        <div class="col-lg-6">2021-02-01</div>
        
    </div>
    <h2>go ã® map ã®ã‚­ãƒ¼ã® Tips</h2>
</div>
<div>
    
    <ul><li>çŸ¥ã£ã¦ãŸ
<ul><li><code>map</code>ã®ã‚­ãƒ¼ã«ã¯<code>struct</code>ãŒä½¿ãˆã‚‹</li><li>ã‚­ãƒ¼ãŒãƒã‚¤ãƒ³ã‚¿ã‚„ãƒã‚¤ãƒ³ã‚¿ã‚’å«ã‚€<code>struct</code>ã®å ´åˆã€ãƒã‚¤ãƒ³ã‚¿ã®æŒ‡ã™å€¤ãŒåŒã˜ã§ã‚‚ãƒã‚¤ãƒ³ã‚¿å€¤è‡ªä½“ãŒæ¯”è¼ƒã•ã‚Œã‚‹ãŸã‚ç•°ãªã‚‹ã‚­ãƒ¼ã¨ãªã‚‹</li></ul></li><li>çŸ¥ã‚‰ãªã‹ã£ãŸ
<ul><li><code>interface</code>ã‚‚ã‚­ãƒ¼ã«ã§ãã‚‹
<ul><li>ã‚­ãƒ¼ã‚’è¿½åŠ ã™ã‚‹ã¨ãã«ãƒã‚¤ãƒ³ã‚¿ã‚’ä½¿ã£ã¦ãªã„ã“ã¨</li></ul></li><li><code>time.Time</code>ã¯ã‚­ãƒ¼ã«ã¤ã“ãŸã‚‰ã‚ã‹ã‚“
<ul><li><a href="https://go.googlesource.com/go/+/go1.15.6/src/time/time.go#147">src/time/time.go - go - Git at Google</a></li><li><a href="https://pkg.go.dev/time#Time">time Â· pkg.go.dev</a><ul><li><blockquote><p>Note that the Go == operator compares not just the time instant but also the Location and the monotonic clock reading. Therefore, Time values should not be used as map or database keys without first guaranteeing that the identical Location has been set for all values, which can be achieved through use of the UTC or Local method, and that the monotonic clock reading has been stripped by setting t = t.Round(0). In general, prefer t.Equal(u) to t == u, since t.Equal uses the most accurate comparison available and correctly handles the case when only one of its arguments has a monotonic clock reading.</p></blockquote></li></ul></li><li>UT ã§ã¯ä¸€è‡´ã—ã¡ã‚ƒã„ãƒã‚°ã‚’è¦‹ã¤ã‘ã‚‰ã‚Œãªã‹ã£ãŸ...ğŸ˜¥</li><li>ã¾ã ã‚ã‹ã£ã¦ãªã„ã®ãŒã€<code>Location</code>ãŒå¿…ãšåŒã˜ã«ãªã‚‹ã‚ˆã†ã«ã—ã¦ãŸï¼†å¹´æœˆæ—¥ã ã‘ã®æƒ…å ±ã—ã‹æŒã£ã¦ãªã‹ã£ãŸã®ã«ãšã‚Œã¨ã‚“ã®ã‹ã„ï¼ï¼Ÿã¨ã„ã†ã¨ã“ã‚</li></ul></li></ul></li></ul><p><a href="https://play.golang.org/p/Rd5OJ2S37AT">ã‚³ãƒ¼ãƒ‰</a>ã€‚ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯<code>time.Time</code>ã®ã‚­ãƒ¼ã®ã‚ºãƒ¬ã¯å†ç¾ã—ãªã„ã‘ã©ã€‚</p><pre><code class="go">package main

import (
	"fmt"
	"time"
)

type Key interface {
}

type KeyA struct {
	s string
}

type KeyB struct {
	s string
	i int
}

type KeyC struct {
	t time.Time
}

type KeyD struct {
	a *KeyA
}

func checkInterfaceKey() {
	m := map[Key]int{}
	m[KeyA{
		s: "A1",
	}] = 1
	m[KeyA{
		s: "A1",
	}] = 2
	m[KeyA{
		s: "A2",
	}] = 3
	m[KeyB{
		s: "B1",
		i: 1,
	}] = 4
	m[KeyB{
		s: "B1",
		i: 1,
	}] = 5
	m[KeyB{
		s: "B1",
		i: 2,
	}] = 6
	fmt.Printf("%v\n", m)
}

func init() {
	location := "Asia/Tokyo"
	loc, err := time.LoadLocation(location)
	if err != nil {
		loc = time.FixedZone(location, 9*60*60)
	}
	time.Local = loc
	fmt.Printf("%v\n", loc)
}

func checkPointerIncludedKey() {
	m := map[Key]int{}
	m[KeyC{
		t: time.Date(2021, 2, 1, 0, 0, 0, 0, time.Local),
	}] = 1
	m[KeyC{
		t: time.Date(2021, 2, 1, 0, 0, 0, 0, time.Local),
	}] = 2
	m[KeyD{
		a: &amp;KeyA{
			s: "D1",
		},
	}] = 3
	m[KeyD{
		a: &amp;KeyA{
			s: "D1",
		},
	}] = 4
	fmt.Printf("%v\n", m)
}

func main() {
	checkInterfaceKey()
	checkPointerIncludedKey()
}

</code></pre>
</div>

<div id="post-tags">
    <b>Tags: </b>
    
    <a href="/tags/go">go</a>
    
</div>


    <div id="prev-next">
        
        <a href="/posts/2021-02-12-various-stories-about-starting-to-use-nodist">&laquo; 2021-02-12 è‰²ã€…ã‚ã£ã¦ Nodist ã‚’ä½¿ã„å§‹ã‚ãŸè©±</a>
        
        
        <a class="right" href="/posts/2021-01-30-beware-to-update-aws-tools">2021-01-30 AWS.Tools.Installer ã§å…¥ã‚ŒãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æ›´æ–°ã¯æ°—ã‚’ã¤ã‘ã‚ã‚ˆ &raquo;</a>
        
    </div>

    


</div>

            </div>
        </div>
    </div>
    <footer>Copyright &copy; 2019-2022 krymtkts
        <p style="text-align: center;">Powered by <a href="http://cryogenweb.org">Cryogen</a></p></footer>
</div>
<script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
<script src="/js/highlight.pack.js" type="application/javascript"></script>
<script>hljs.initHighlightingOnLoad();</script>


</body>
</html>
